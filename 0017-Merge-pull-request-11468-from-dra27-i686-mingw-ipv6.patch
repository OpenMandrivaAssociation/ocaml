From defecc867a0b5653554c41b06e78c0f24f6c10a8 Mon Sep 17 00:00:00 2001
From: David Allsopp <david.allsopp@metastack.com>
Date: Tue, 2 Aug 2022 17:21:08 +0100
Subject: [PATCH 17/24] Merge pull request #11468 from dra27/i686-mingw-ipv6

Fix detection of IPv6 on mingw-w64 i686

(cherry picked from commit 98392895940cc1c18534280ae001b70fa5bf24c2)
---
 Changes      |   4 ++++
 configure    | Bin 581563 -> 581611 bytes
 configure.ac |   1 +
 3 files changed, 5 insertions(+)

diff --git a/Changes b/Changes
index 99907b950a..6b537edca9 100644
--- a/Changes
+++ b/Changes
@@ -37,6 +37,10 @@ OCaml 4.14 maintenance branch
 - #11417: Fix regression allowing virtual methods in non-virtual classes.
   (Leo White, review by Florian Angeletti)
 
+- #11468: Fix regression from #10186 (OCaml 4.13) detecting IPv6 on Windows for
+  mingw-w64 i686 port.
+  (David Allsopp, review by Xavier Leroy and SÃ©bastien Hinderer)
+
 OCaml 4.14.0 (28 March 2022)
 ----------------------------
 
diff --git a/configure b/configure
index c0dde03f183f86677b22a81238defdba60ad0080..536a1cbee58a430692bfa3de11901e7e2f6b4ee2 100755
GIT binary patch
delta 53
zcmdnJU-|WZ<%Sl<7N!>F7M2#)7Pc+y(YK}x+-47$p3}xEG`-+2o7nVsH`#OBfnwVQ
JZgZ?=0RTku6-595

delta 53
zcmV-50LuUCzazW9BY=bfgaU*Egam{Iga)(+TiTa!+Xo<*Y=#9AmvH?C7MJeX2fc@o
L+XuIh+X!0(RZ<pp

diff --git a/configure.ac b/configure.ac
index 13d6d1a326..ebb8bbdb80 100644
--- a/configure.ac
+++ b/configure.ac
@@ -2016,6 +2016,7 @@ AS_CASE([$host],
   [*-*-mingw32],
     [AC_DEFINE([HAS_BROKEN_PRINTF])
     AC_DEFINE([HAS_STRERROR])
+    AC_DEFINE([HAS_IPV6])
     AC_DEFINE([HAS_NICE])],
   [*-pc-windows],
     [AC_DEFINE([HAS_BROKEN_PRINTF])
-- 
2.37.0.rc2

